<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Finance Tracker</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        #transaction-form {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 20px;
        }
        #transactions-list {
            border-top: 1px solid #ccc;
        }
        .transaction {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }
    </style>
</head>
<body>
    <h1>Finance Tracker</h1>
    
    <form id="transaction-form">
        <input type="number" id="amount" placeholder="Amount" required>
        <select id="type" required>
            <option value="income">Income</option>
            <option value="expense">Expense</option>
        </select>
        <input type="text" id="category" placeholder="Category" required>
        <input type="text" id="description" placeholder="Description (optional)">
        <button type="submit">Add Transaction</button>
    </form>

    <div id="transactions-list"></div>

    <script>
        const form = document.getElementById('transaction-form');
        const transactionsList = document.getElementById('transactions-list');

        async function fetchTransactions() {
            const response = await fetch('/transactions');
            const transactions = await response.json();
            transactionsList.innerHTML = transactions.map(t => `
                <div class="transaction">
                    <span>${t.date.split('T')[0]} - ${t.category}</span>
                    <span style="color:${t.transaction_type === 'income' ? 'green' : 'red'}">
                        ${t.transaction_type === 'income' ? '+' : '-'}$${t.amount}
                    </span>
                </div>
            `).join('');
        }

        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            const transaction = {
                amount: document.getElementById('amount').value,
                type: document.getElementById('type').value,
                category: document.getElementById('category').value,
                description: document.getElementById('description').value
            };

            await fetch('/add_transaction', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(transaction)
            });

            form.reset();
            fetchTransactions();
        });

        fetchTransactions();
    </script>
</body>
</html>
